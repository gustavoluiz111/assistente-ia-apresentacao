<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat - Recicla Tech</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
<style>
:root {
  --dark-blue: #0a0f1e;
  --light-neutral: #f4f6f8;
  --neon-cyan: #00ffff;
}

/* BODY */
body {
  margin: 0;
  font-family: 'Orbitron', sans-serif;
  background-color: var(--dark-blue);
  color: var(--light-neutral);
  overflow-x: hidden;
  height: 100vh;
  overflow: hidden;
}

/* HEADER */
header { 
  position:fixed; top:0; left:0; width:100%; padding:20px; 
  display:flex; align-items:center; z-index:1000; 
}

/* HAMBURGER */
.hamburger-toggle {
  position:relative; z-index:1001; background:none; border:none; cursor:pointer;
  display:flex; flex-direction:column; justify-content:space-around;
  width:40px; height:32px;
}
.hamburger-toggle .bar {
  display:block; width:100%; height:4px; background:var(--light-neutral);
  border-radius:3px; transition: all 0.3s ease-in-out;
}
.hamburger-toggle.open .bar:nth-child(1) { transform: rotate(45deg) translate(6px,7px); }
.hamburger-toggle.open .bar:nth-child(2) { opacity:0; }
.hamburger-toggle.open .bar:nth-child(3) { transform: rotate(-45deg) translate(6px,-7px); }

/* NAV MENU */
.nav-menu {
  position:fixed; top:0; left:0; width:280px; height:100vh;
  background: var(--dark-blue); padding-top:100px; padding-left:30px;
  transform:translateX(-100%); transition: transform 0.4s cubic-bezier(0.23,1,0.32,1);
  z-index:999;
}
.nav-menu.open { transform:translateX(0); }
.nav-menu ul { list-style:none; }
.nav-menu ul li { margin-bottom:25px; }
.nav-menu ul li a {
  color:var(--light-neutral); text-decoration:none; font-size:1.5rem;
  font-weight:bold; transition:color 0.2s ease;
}
.nav-menu ul li a:hover, .nav-menu ul li a.active { color:var(--neon-cyan); }

/* CANVAS */
canvas#particles, canvas#three-canvas {
  position: fixed; top:0; left:0; width:100%; height:100%;
  pointer-events: none; z-index:0;
}

/* MICROFONE FIXO */
#micButton {
  position: fixed;
  bottom: 90px;
  left: 20px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: none;
  background: var(--neon-cyan);
  color: var(--dark-blue);
  font-size: 1.5rem;
  cursor: pointer;
  z-index: 10000;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 15px var(--neon-cyan);
}
#micButton.listening {
  background: red;
  color: white;
}

/* ===== Estilização do Chat ===== */
.chat-container {
  position: left;
  width: 400px;
  height: 600px;
  background-color: #2a2a3b;
  border-radius: 15px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 0 20px rgba(0,0,0,0.5);
  z-index: 1000;
}

.messages {
  flex: 1;
  padding: 15px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.message {
  max-width: 80%;
  padding: 10px 15px;
  border-radius: 12px;
  color: white;
  font-size: 14px;
  word-wrap: break-word;
}

.message.user {
  align-self: flex-end;
  background-color: #4a90e2;
}

.message.bot {
  align-self: flex-start;
  background-color: #44475a;
}

.input-area {
  display: flex;
  padding: 10px;
  background-color: #1f1f2f;
  gap: 5px;
  align-items: center;
}

.input-area input[type="text"] {
  flex: 1;
  padding: 10px;
  border-radius: 10px;
  border: none;
  outline: none;
  font-size: 14px;
}

.input-area button {
  background-color: #4a90e2;
  border: none;
  border-radius: 50%;
  color: white;
  width: 40px;
  height: 40px;
  cursor: pointer;
  font-size: 18px;
}

/* Ocultar inputs de arquivo padrão */
input[type="file"], input[type="file"].camera {
  display: none;
}
</style>
</head>
<body>
<canvas id="particles"></canvas>
<canvas id="three-canvas"></canvas>

<!-- ===== Header ===== -->
<header>
  <button class="hamburger-toggle" aria-label="Abrir menu">
    <span class="bar"></span>
    <span class="bar"></span>
    <span class="bar"></span>
  </button>
</header>

<!-- ===== Menu ===== -->
<nav class="nav-menu">
  <ul>
    <li><a href="index.html">Início</a></li>
    <li><a href="projetos.html">Projetos</a></li>
    <li><a href="lixo.html">Lixo Eletrônico</a></li>
    <li><a href="ia.html" class="active">IA</a></li>
    <li><a href="creditos.html">Créditos</a></li>
  </ul>
</nav>

<div class="chat-container">
  <div class="messages" id="messages"></div>
  <div class="input-area">
    <!-- Botões SVG -->
    <button id="btn-attach" title="Adicionar arquivo">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" fill="white">
        <path d="M16.5,6.5v11a4.5,4.5,0,0,1-9,0v-9a3,3,0,0,1,6,0v9a1.5,1.5,0,0,1-3,0V9h-2v9a3.5,3.5,0,0,0,7,0v-9a5,5,0,0,0-10,0v11a6,6,0,0,0,12,0v-11Z"/>
      </svg>
    </button>
    <button id="btn-gallery" title="Abrir galeria">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" fill="white">
        <path d="M21 19V5a2 2 0 0 0-2-2H5a2 
        2 0 0 0-2 2v14a2 2 0 0 0 2 
        2h14a2 2 0 0 0 2-2ZM5 5h14v5l-3.5-3.5-4.5 
        6L8 10l-3 4Z"/>
      </svg>
    </button>
    <button id="btn-camera" title="Abrir câmera">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" fill="white">
        <path d="M20 5h-3.17l-1.84-2H9.01L7.17 
        5H4a2 2 0 0 0-2 2v11a2 2 0 0 
        0 2 2h16a2 2 0 0 0 2-2V7a2 2 
        0 0 0-2-2Zm-8 13a5 5 0 1 1 0-10 
        5 5 0 0 1 0 10Z"/>
      </svg>
    </button>
    <button id="btn-mic" title="Falar">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" fill="white">
        <path d="M12 14a3 3 0 0 0 3-3V5a3 
        3 0 0 0-6 0v6a3 3 0 0 0 3 
        3Zm5-3a5 5 0 0 1-10 0H5a7 
        7 0 0 0 14 0h-2Z"/>
      </svg>
    </button>
    <input type="text" id="input-msg" placeholder="Digite uma mensagem..." />
    <button id="btn-send" title="Enviar">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" fill="white">
        <path d="M2 21 23 12 2 3v7l15 
        2-15 2v7Z"/>
      </svg>
    </button>

    <!-- Inputs escondidos -->
    <input type="file" id="file-input" multiple />
    <input type="file" id="gallery-input" accept="image/*" multiple />
    <input type="file" id="camera-input" accept="image/*" capture="environment" class="camera" />
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
<script>
  // ===== HAMBURGER =====
  const hamburgerToggle = document.querySelector('.hamburger-toggle');
  const navMenu = document.querySelector('.nav-menu');
  hamburgerToggle.addEventListener('click', () => {
    hamburgerToggle.classList.toggle('open');
    navMenu.classList.toggle('open');
  });

  // ===== PARTICULAS =====
  const canvas = document.getElementById('particles');
  const ctx = canvas.getContext('2d');
  let particles = [];
  function resize() { canvas.width=window.innerWidth; canvas.height=window.innerHeight; }
  window.addEventListener('resize', resize); resize();
  function createParticles() {
    for(let i=0;i<100;i++){
      particles.push({ x:Math.random()*canvas.width, y:Math.random()*canvas.height, r:Math.random()*2+1, dx:(Math.random()-0.5)*0.5, dy:(Math.random()-0.5)*0.5 });
    }
  }
  createParticles();
  function animateParticles(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    particles.forEach(p=>{
      ctx.beginPath();
      ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
      ctx.fillStyle='rgba(0,255,255,0.7)';
      ctx.fill();
      p.x+=p.dx; p.y+=p.dy;
      if(p.x<0||p.x>canvas.width)p.dx*=-1;
      if(p.y<0||p.y>canvas.height)p.dy*=-1;
    });
    requestAnimationFrame(animateParticles);
  }
  animateParticles();

  // ===== THREE.JS 3D =====
  const threeCanvas=document.getElementById('three-canvas');
  const scene3D=new THREE.Scene();
  const camera=new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight,0.1,1000);
  const renderer=new THREE.WebGLRenderer({canvas:threeCanvas, alpha:true});
  renderer.setSize(window.innerWidth,window.innerHeight);

  const geometry=new THREE.BoxGeometry();
  const material=new THREE.MeshBasicMaterial({color:0x00ffff, wireframe:true});
  const cubes=[];
  for(let i=0;i<50;i++){
    const cube=new THREE.Mesh(geometry, material);
    cube.position.set((Math.random()-0.5)*50,(Math.random()-0.5)*50,(Math.random()-0.5)*50);
    scene3D.add(cube);
    cubes.push(cube);
  }
  camera.position.z=30;

  const lines=[];
  for(let i=0;i<50;i++){
    const a=cubes[i];
    const b=cubes[(i+Math.floor(Math.random()*cubes.length))%cubes.length];
    const points=[new THREE.Vector3(a.position.x,a.position.y,a.position.z),new THREE.Vector3(b.position.x,b.position.y,b.position.z)];
    const geometryLine=new THREE.BufferGeometry().setFromPoints(points);
    const lineMaterial=new THREE.LineBasicMaterial({color:0x00ffff, transparent:true, opacity:0.6});
    const line=new THREE.Line(geometryLine,lineMaterial);
    scene3D.add(line);
    lines.push({line,a,b,t:Math.random()});
  }

  function animate3D(){
    requestAnimationFrame(animate3D);
    cubes.forEach(c=>{ c.rotation.x+=0.002; c.rotation.y+=0.003; });
    lines.forEach(obj=>{
      obj.t+=0.01;
      const posA=obj.a.position;
      const posB=obj.b.position;
      const lerpX=posA.x+(posB.x-posA.x)*(0.5+0.5*Math.sin(obj.t));
      const lerpY=posA.y+(posB.y-posA.y)*(0.5+0.5*Math.sin(obj.t));
     
      const lerpZ=posA.z+(posB.z-posA.z)*(0.5+0.5*Math.sin(obj.t));
      obj.line.geometry.setFromPoints([new THREE.Vector3(posA.x,posA.y,posA.z), new THREE.Vector3(lerpX,lerpY,lerpZ)]);
      obj.line.material.opacity=0.3+0.4*Math.sin(obj.t*2);
    });
    camera.position.x=Math.sin(Date.now()*0.0005)*10;
    camera.position.y=Math.cos(Date.now()*0.0005)*5;
    camera.lookAt(0,0,0);
    renderer.render(scene3D,camera);
  }
  animate3D();

  window.addEventListener('resize',()=>{
    camera.aspect=window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth,window.innerHeight);
  });

  // ===== CHAT =====
  const messages = document.getElementById("messages");
  const inputMsg = document.getElementById("input-msg");
  const btnSend = document.getElementById("btn-send");

  const fileInput = document.getElementById("file-input");
  const galleryInput = document.getElementById("gallery-input");
  const cameraInput = document.getElementById("camera-input");

  const btnAttach = document.getElementById("btn-attach");
  const btnGallery = document.getElementById("btn-gallery");
  const btnCamera = document.getElementById("btn-camera");
  const btnMic = document.getElementById("btn-mic");

  function addMessage(text, type="user") {
    const div = document.createElement("div");
    div.classList.add("message", type);
    div.textContent = text;
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;
  }

  async function callGeminiAPI(promptText){
  try {
    const response = await fetch("https://api.gemini.com/v1/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer chave api aqui"
      },
      body: JSON.stringify({
        model: "gemini-1.5",
        prompt: promptText,
        max_tokens: 300
      })
    });
    const data = await response.json();
    return data.choices[0].text || "Sem resposta";
  } catch(err) {
    console.error(err);
    return "Erro ao se conectar com a API.";
  }
  }
  btnSend.addEventListener("click", async () => {
    const text = inputMsg.value.trim();
    if(text) {
      addMessage(text, "user");
      inputMsg.value = "";
      addMessage("Digitando...", "bot");
      const botResp = await callGeminiAPI(`Leia o site reciclatech.com.br e responda sobre: ${text}`);
      // Remove mensagem "Digitando..."
      const typingMsg = document.querySelector(".message.bot:last-child");
      if(typingMsg) typingMsg.remove();
      addMessage(botResp, "bot");
    }
  });

  inputMsg.addEventListener("keypress", (e) => {
    if(e.key === "Enter") btnSend.click();
  });

  // ===== Botões de arquivo =====
  btnAttach.addEventListener("click", () => fileInput.click());
  btnGallery.addEventListener("click", () => galleryInput.click());
  btnCamera.addEventListener("click", () => cameraInput.click());

  fileInput.addEventListener("change", (e) => {
    for(const file of e.target.files) addMessage(`Arquivo enviado: ${file.name}`);
  });

  galleryInput.addEventListener("change", (e) => {
    for(const file of e.target.files) addMessage(`Imagem enviada: ${file.name}`);
  });

  cameraInput.addEventListener("change", (e) => {
    for(const file of e.target.files) addMessage(`Foto tirada: ${file.name}`);
  });

  // ===== Botão microfone =====
  btnMic.addEventListener("click", () => {
    addMessage("Gravação de áudio iniciada...", "user");
    setTimeout(() => addMessage("Áudio enviado!", "user"), 2000);
  });

</script>
</body>
</html>
