<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assistente IA - Projeto IPA</title>
  <link rel="stylesheet" href="css/pro.css"> <!-- CSS do site j√° feito -->
  <style>
    /* Estilos do fundo futurista com cubos */
    canvas#bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    /* Estilos do chatbox estilo aplicativo de mensagens */
    .chat-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 360px;
      max-width: 90%;
      height: 500px;
      background: rgba(10,10,10,0.9);
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      box-shadow: 0 0 20px #00f;
      overflow: hidden;
    }

    .chat-messages {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
    }

    .message {
      margin-bottom: 10px;
      padding: 10px 15px;
      border-radius: 15px;
      max-width: 80%;
      word-wrap: break-word;
      font-size: 14px;
    }

    .message.user {
      background: #007bff;
      color: white;
      align-self: flex-end;
    }

    .message.bot {
      background: #1f1f1f;
      color: #00ffea;
      align-self: flex-start;
    }

    .chat-input {
      display: flex;
      padding: 10px;
      background: rgba(20,20,20,0.95);
    }

    .chat-input input {
      flex: 1;
      padding: 10px 15px;
      border-radius: 20px;
      border: none;
      outline: none;
      font-size: 14px;
      margin-right: 5px;
    }

    .chat-input button {
      background: #00ffea;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }

    .chat-input button:hover {
      background: #00ccbb;
    }

    #status {
      text-align: center;
      color: #0ff;
      font-size: 12px;
      margin-top: 5px;
    }

  </style>
</head>
<body>

  <!-- Fundo futurista animado -->
  <canvas id="bg"></canvas>

  <!-- Cabe√ßalho -->
  <header>
    <h1 style="color:#0ff;text-align:center;padding:10px;">Assistente IA - Projeto IPA</h1>
  </header>

  <!-- Chatbox -->
  <div class="chat-container">
    <div class="chat-messages" id="chat"></div>
    <div id="status"></div>
    <div class="chat-input">
      <input type="text" id="question-input" placeholder="Digite sua pergunta...">
      <button id="btn-voice">üé§</button>
      <button id="btn-send">‚û°Ô∏è</button>
    </div>
  </div>

  <script>
    // Fun√ß√£o para carregar o arquivo JSON com as perguntas e respostas
    async function loadQuestions() {
      try {
        const response = await fetch('https://raw.githubusercontent.com/gustavoluiz111/assistente-ia-apresentacao/main/perguntas1.json');
        const data = await response.json();
        return data;
      } catch (error) {
        console.error('Erro ao carregar o arquivo JSON:', error);
        return [];
      }
    }

    // Fun√ß√£o para inicializar o chat
    async function initChat() {
      const questions = await loadQuestions();
      const chat = document.getElementById('chat');
      const input = document.getElementById('question-input');
      const btnSend = document.getElementById('btn-send');
      const btnVoice = document.getElementById('btn-voice');
      const status = document.getElementById('status');

      // Fun√ß√£o para adicionar mensagens ao chat
      function addMessage(text, sender) {
        const msg = document.createElement('div');
        msg.classList.add('message', sender);
        msg.textContent = text;
        chat.appendChild(msg);
        chat.scrollTop = chat.scrollHeight;
      }

      // Fun√ß√£o para obter a resposta com base na pergunta
      function getResponse(question) {
        question = question.toLowerCase();
        for (const q of questions) {
          if (question.includes(q.pergunta.toLowerCase())) {
            return q.resposta;
          }
        }
        return "Desculpe, n√£o entendi sua pergunta.";
      }

      // Enviar pergunta e receber resposta
      function sendQuestion() {
        const question = input.value.trim();
        if (!question) return;

        addMessage(question, 'user');
        input.value = '';
        status.textContent = 'Processando resposta...';

        setTimeout(() => {
          const answer = getResponse(question);
          addMessage(answer, 'bot');
          status.textContent = '';
          // S√≠ntese de voz
          if ('speechSynthesis' in window) {
            const utter = new SpeechSynthesisUtterance(answer);
            utter.lang = 'pt-BR';
            window.speechSynthesis.speak(utter);
          }
        }, 500);
      }

      btnSend.addEventListener('click', sendQuestion);
      input.addEventListener('keydown', e => {
        if (e.key === 'Enter') sendQuestion();
      });

      // Reconhecimento de voz
      let recognition;
      if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        recognition.lang = 'pt-BR';
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        recognition.addEventListener('start', () => {
          status.textContent = 'Escutando... Fale agora.';
        });

        recognition.addEventListener('result', (event) => {
          const transcript = event.results[0][0].transcript;
          input.value = transcript;
          status.textContent = 'Pergunta captada. Enviando...';
          sendQuestion();
        });

        recognition.addEventListener('error', (event) => {
          status.textContent = 'Erro no reconhecimento de voz: ' + event.error;
        });

        recognition.addEventListener('end', () => {
          status.textContent = '';
        });

        btnVoice.addEventListener('click', () => {
          recognition.start();
        });
      } else {
        btnVoice.disabled = true;
        status.textContent = 'Reconhecimento de voz n√£o suportado neste navegador.';
      }
    }

    initChat();
  </script>

  <!-- Script do fundo futurista com cubos -->
  <script src="js/cubos.js"></script>

</body>
</html>

