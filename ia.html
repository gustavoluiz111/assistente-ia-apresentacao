<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assistente IA - EcoRobÃ´s</title>
<link rel="stylesheet" href="css/universal.css">
<script src="js/universal.js" defer></script>
<script src="js/chat.js" defer></script>
<style>
/* Chatbox estilo WhatsApp */
#chat-container {
  position: relative;
  max-width: 400px;
  margin: 120px auto;
  background: rgba(255,255,255,0.05);
  border-radius: 15px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  height: 600px;
  box-shadow: 0 0 20px rgba(0,0,0,0.3);
  z-index: 10;
}
#chat {
  flex: 1;
  padding: 10px;
  overflow-y: auto;
}
.message { 
  margin: 5px 0; 
  padding: 8px 12px; 
  border-radius: 12px; 
  max-width: 80%;
  word-wrap: break-word;
}
.user { background: #0084ff; color: white; align-self: flex-end; }
.bot { background: #e5e5ea; color: black; align-self: flex-start; }
#input-container {
  display: flex;
  border-top: 1px solid #ccc;
}
#question-input { flex: 1; padding: 10px; border: none; outline: none; background: rgba(255,255,255,0.1); color: white; }
#btn-send, #btn-voice { padding: 0 15px; cursor: pointer; background: none; border: none; color: white; font-size: 18px; }
#status { text-align: center; font-size: 14px; color: white; margin-top: 5px; }
</style>
</head>
<body>
<header><!-- cabeÃ§alho universal jÃ¡ existente --></header>

<!-- Fundo com cubos animados -->
<div id="background-cubes"><!-- cubos animados do universal.js --></div>

<div id="chat-container">
  <div id="chat"></div>
  <div id="input-container">
    <input type="text" id="question-input" placeholder="Digite sua pergunta...">
    <button id="btn-voice">ðŸŽ¤</button>
    <button id="btn-send">Enviar</button>
  </div>
  <div id="status"></div>
</div>

<footer><!-- rodapÃ© universal jÃ¡ existente --></footer>

<script>
// FunÃ§Ãµes bÃ¡sicas do chat puxando do chat.js
const chatContainer = document.getElementById('chat');
const input = document.getElementById('question-input');
const sendBtn = document.getElementById('btn-send');
const voiceBtn = document.getElementById('btn-voice');
const status = document.getElementById('status');

function addMessage(text, sender) {
  const msg = document.createElement('div');
  msg.classList.add('message', sender);
  msg.textContent = text;
  chatContainer.appendChild(msg);
  chatContainer.scrollTop = chatContainer.scrollHeight;
}

// Envio de mensagens
sendBtn.addEventListener('click', () => {
  const question = input.value.trim();
  if (!question) return;
  addMessage(question, 'user');
  input.value = '';
  const answer = getResponse(question);
  setTimeout(() => addMessage(answer, 'bot'), 300);
});

// Enter envia mensagem
input.addEventListener('keypress', (e) => {
  if (e.key === 'Enter') sendBtn.click();
});

// Reconhecimento de voz
let recognition;
if ('webkitSpeechRecognition' in window) {
  recognition = new webkitSpeechRecognition();
  recognition.lang = 'pt-BR';
  recognition.continuous = false;
  recognition.interimResults = false;

  recognition.onresult = (event) => {
    const voiceText = event.results[0][0].transcript;
    input.value = voiceText;
    sendBtn.click();
  };

  recognition.onerror = (event) => {
    status.textContent = "Erro no reconhecimento de voz.";
    setTimeout(()=> status.textContent="", 2000);
  };
  
  voiceBtn.addEventListener('click', () => {
    recognition.start();
    status.textContent = "Ouvindo...";
  });

} else {
  voiceBtn.disabled = true;
  status.textContent = "Reconhecimento de voz nÃ£o suportado neste navegador.";
}
</script>
</body>
</html>
